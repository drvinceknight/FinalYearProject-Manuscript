%!TEX root = ../main.tex

\chapter{Results}\label{cha:results}

In this chapter, the implementation of a fingerprint function within the Axelrod-Python library will be examined.
This includes the addition of two strategy transformers, the Dual and JossAnn as defined in \ref{}. %TODO
Then several results will be presented where analytical fingerprints are compared with analytical ones.
A discussion that compares different fingerprints of strategies within Axelrod-Python will also be given.

\section{The Dual}
The dual of a strategy is defined such that when when the original strategy and the dual are presented with identical histories they will return opposite actions.
This relies on knowledge of how the original strategy would have behaved in a given situation, would be impractical to infer from the source code, however, the required behaviour can be achieved by having the original strategy as an attribute of the dual.
Whenever the dual has to submit a move, it can first get the original strategy to suggest what move should it would have made, and then flip that action.

\IncMargin{1.2em}
\begin{algorithm}[H]
 \KwData{A strategy}
 \KwResult{The d of the strategy}{}
  \If{First Turn}{
   create copy of original strategy\;}
  simulate original strategy\;
  update original strategy's history/internal state\;
  \Return{Flip of original strategy's move}
 \caption{The Dual of a Strategy}
\end{algorithm}\DecMargin{1.5em}

\section{Fingerprint}\label{sec:fingerprint-implementation}

fingerprint is just expected score against Joss Ann.
take a sample of x,y values, then play the strategy against the joss ann for a long time and take the average score per turn to estimate expected score.
Do this for lots of x,y and then plot the result, should get the same.
talk about turns, repetitions and step size.

\section{Comparison of Analytical and Numerical Plots}

In figure \ref{fig:ashlock-fingerprints}, several analytical fingerprints from previous literature are shown \cite{Ashlock2004}.
Colourings and shadings are used to make certain features stand out, and an attempt to replicate this behaviour was implemented in Axelrod-Python.
The popular plotting library matplotlib has many options for different colour maps which are demonstrated in Appendix . %TODO

\begin{figure}[hbtp!]
    \begin{center}
        \includegraphics[width = 0.6\textwidth]{../img/MultipleFingerprintsAshlock}
    \end{center}
    \caption{Shaded plots of the fingerprint functions for the strategies TitForTat, Psycho, AllD and AllC, in reading order.}
    \label{fig:ashlock-fingerprints}
\end{figure}

Using the analytical fingerprints from previous literature, and the fingerprint formulae provided alongside them, the most appropriate colour map was chosen.
The colour map Seismic was selected due to its divergent properties (although all colour maps are available within the library).
With divergent colour maps, all extreme values (high or low) are coloured, whilst mid range values are left white.
This highlights areas of interest, and in Figure \ref{fig:WSLS-ashlock-comparison} it can be seen that this matches previous work very well.

\begin{figure}[hbtp!]
\centering
\subfloat[WSLS fingerprint from previous literature]{\includegraphics[width = 0.4\textwidth]{../img/WSLS-Ashlock}}
\subfloat[Analytical WSLS fingerprint demonstrating Seismic colouring]{\includegraphics[width = 0.7\textwidth]{../img/WSLS-Analytical}}
\caption{A comparison of a fingerprint plot from previous literature to asses the suitability of the Seismic colour map}
\label{fig:WSLS-ashlock-comparison}
\end{figure}

With the knowledge that the choice of colourmap is appropriate, a comparison can now be made between analytical fingerprints and numerical ones obtained via the Axelrod-Python library.
Table \ref{tab:fingerprint-functions} gives the exact fingerprint functions of several well known strategies that will then be used to validate the numerical versions.

\begin{table}[htbp]
\centering
\renewcommand{\arraystretch}{2}
\setlength{\tabcolsep}{12pt}
\begin{tabular}{l l}
\toprule
Strategy & Analytical Fingerprint Function\\
\midrule
TitForTat &  $\displaystyle \frac{y^2 + 5xy + 3x^2}{(x + y)^2} $\\
Psycho (Anti TitForTat& $\displaystyle \frac{4(y-1)(x-1) + 5(y-1)^2}{2(y-1)(x-1) + (x-1)^2 + (y-1)^2} $ \\
WinStayLoseShit (Pavlov) & $\displaystyle \frac{(3x+y)(x-1) + 5y(y-1)}{(x+2y)(x-1) + y(y-1)} $\\
AllC (Cooperator) & $\displaystyle 3 - 3y $ \\
AllD (Defector) & $\displaystyle 4x + 1 $\\
\bottomrule
\end{tabular}
\caption{A selection of exact fingerprint functions for well known strategies. The probe used is TitForTat.}
\label{tab:fingerprint-functions}
\end{table}

Figures \ref{fig:TFT-comparison} \ref{fig:Psycho-comparison} \ref{fig:WSLS-comparison} \ref{fig:Cooperator-comparison} \ref{fig:Defector-comparison} compare plots of known exact fingerprint functions with analytical approximations obtained with the Axelrod-Python library.
The analytical plots were created with the code seen in listing \ref{lst:create-several-fingerprints}.
The parameters \mintinline{python}{turns=500, repetitions=200, step=0.01} are as described in section \ref{sec:fingerprint-implementation}.
The parameter \mintinline{python}{processes=0} ensures that the function will use the maximum number of cores available on the computer.

\begin{listing}[hbtp!]
\begin{ExampleCode}
import axelrod as axl
strats = [axl.TitForTat, axl.WinStayLoseShift, axl.AntiTitForTat,
          axl.Cooperator, axl.Defector]
for s in strats:
    probe = axl.TitForTat
    af = axl.AshlockFingerprint(s, probe)
    data = af.fingerprint(turns=500, repetitions=200, step=0.01, processes=0)
    p = af.plot()
    p.savefig('{}-Numerical.pdf'.format(s.name))
\end{ExampleCode}
\caption{Code to create the numerical plots for several strategies}
\label{lst:create-several-fingerprints}
\end{listing}

\begin{figure}[htbp!]
\subfloat[Exact analytical fingerprint]{\includegraphics[width = 0.5\textwidth]{../img/TFT-Analytical.pdf}}
% \subfloat[Numerical Fingerprint]{\includegraphics[width = 0.5\textwidth]{../img/Numerical/TitForTat.pdf}}
\caption{A comparison of the analytical fingerprint of TitForTat and the numerical version produced by Axelrod-Python library.}
\label{fig:TFT-comparison}
\end{figure}
\begin{figure}[htbp!]
\subfloat[Exact analytical fingerprint]{\includegraphics[width = 0.5\textwidth]{../img/Psycho-Analytical.pdf}}
% \subfloat[Numerical Fingerprint]{\includegraphics[width = 0.5\textwidth]{../img/Numerical/TitForTat.pdf}}
\caption{A comparison of the analytical fingerprint of Psycho and the numerical version produced by Axelrod-Python library.}
\label{fig:Psycho-comparison}
\end{figure}
\begin{figure}[htbp!]
\subfloat[Exact analytical fingerprint]{\includegraphics[width = 0.5\textwidth]{../img/WSLS-Analytical.pdf}}
% \subfloat[Numerical Fingerprint]{\includegraphics[width = 0.5\textwidth]{../img/Numerical/TitForTat.pdf}}
\caption{A comparison of the analytical fingerprint of WinStayLoseShit and the numerical version produced by Axelrod-Python library.}
\label{fig:WSLS-comparison}
\end{figure}
\begin{figure}[htbp!]
\subfloat[Exact analytical fingerprint]{\includegraphics[width = 0.5\textwidth]{../img/AllC-Analytical.pdf}}
% \subfloat[Numerical Fingerprint]{\includegraphics[width = 0.5\textwidth]{../img/Numerical/TitForTat.pdf}}
\caption{A comparison of the analytical fingerprint of Cooperator and the numerical version produced by Axelrod-Python library.}
\label{fig:Cooperator-comparison}
\end{figure}
\begin{figure}[htbp!]
\subfloat[Exact analytical fingerprint]{\includegraphics[width = 0.5\textwidth]{../img/AllD-Analytical.pdf}}
% \subfloat[Numerical Fingerprint]{\includegraphics[width = 0.5\textwidth]{../img/Numerical/TitForTat.pdf}}
\caption{A comparison of the analytical fingerprint of Defector and the numerical version produced by Axelrod-Python library.}
\label{fig:Defector-comparison}
\end{figure}
